<!DOCTYPE HTML>
<html>
<head>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://demos.lightstreamer.com/commons/require.js"></script>
    <script src="https://demos.lightstreamer.com/commons/lightstreamer.min.js"></script>

</head>
<body class="bg-offwhite h-screen flex flex-col justify-between items-center">
    <div class="text-center mt-20">
        <div class="text-2xl font-bold mb-4">ISS Space Station urine tank level is <span id="urine-tank-level" class="font-mono"></span>%</div>
        <div class="text-lg">Last updated <span id="urine-tank-level-update-seconds" class="font-mono"></span> seconds ago.</div>
    </div>

    <div id="color-bar" class="w-full transition-all duration-500 ease-in-out"></div>
    <script>
            require(["LightstreamerClient", "Subscription"], function (LightstreamerClient, Subscription) {
                var client = new LightstreamerClient("https://push.lightstreamer.com", "ISSLIVE");
                client.connect();

                var lastUpdateTimestamp = null;

                var subUrineTank = new Subscription("MERGE", ["NODE3000005"], ["Value", "TimeStamp"]);
                subUrineTank.addListener({
                    onItemUpdate: function (update) {
                        var value = update.getValue("Value");
                        var element = document.getElementById("urine-tank-level");
                        element.innerText = value;

                        lastUpdateTimestamp = new Date().getTime();

                        // Update color bar height
                        var colorBar = document.getElementById("color-bar");
                        var urineTankLevel = Math.min(value, 100);
                        colorBar.style.height = 100 + "%";

                        //colorBar.style.height = urineTankLevel + "%";
                        colorBar.classList.add("bg-urine");
                    }
                });
                client.subscribe(subUrineTank);

                setInterval(function () {
                    if (lastUpdateTimestamp !== null) {
                        var secondsAgo = Math.floor((new Date().getTime() - lastUpdateTimestamp) / 1000);
                        document.getElementById("urine-tank-level-update-seconds").innerText = secondsAgo;
                    }
                }, 1000);
            });
    </script>
</body>
<style>
    .highlight {
        animation: hifade 0.5s;
    }

    @keyframes hifade {
        from {
            background: yellow;
        }

        to {
            background: transparent;
        }
    }

    .bg-urine {
        background-color: #fdee00; /* Pipi yellow */
    }

    .bg-offwhite {
        background-color: #f8f8ff; /* Off white) */
    }
</style>
</html>